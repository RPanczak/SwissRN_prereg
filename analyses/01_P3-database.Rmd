---
title: "SNF preregistrations"
subtitle: "EDA of P3 database"
author: "Radek Panczak & Evie Vergauwe"
date: "`r Sys.Date()`"
output:
  rmdformats::robobook:
    code_folding: show
    self_contained: true
    highlight: pygments
editor_options: 
  chunk_output_type: console
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding, output_dir = "../docs") })
---

```{r r-setup, include = FALSE}
options(scipen = 999)
options(max.print = "75")
set.seed(12345)

library(pacman)
p_load(fst, tidyverse, magrittr, kableExtra)
```


```{r knit-setup, include = FALSE}
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())

knitr::opts_chunk$set(cache = FALSE,
                      prompt = FALSE,
                      tidy = FALSE,
                      comment = NA,
                      message = FALSE,
                      warning = FALSE,
                      echo = FALSE)
knitr::opts_knit$set(width = 75)

mu <- Hmisc::markupSpecs$html
```

<!-- ----------------------------------------------------- -->

# Data

Downloads from [SNF website](http://p3.snf.ch/Pages/DataAndDocumentation.aspx):

- `P3_GrantExport`
- `P3_GrantExport_with_abstracts`
- `P3_PersonExport`
- `P3_PublicationExport`
- `P3_GrantOutputDataExport`
- `P3_CollaborationExport`

```{r}
download.file(url = 'http://p3.snf.ch/P3Export/P3_GrantExport.csv',
              destfile = 'data-raw/P3/P3_GrantExport.csv',
              method = 'curl')

zip(zipfile = "data-raw/P3/P3_GrantExport", 
    files = "data-raw/P3/P3_GrantExport.csv")

file.remove("data-raw/P3/P3_GrantExport.csv")



download.file(url = 'http://p3.snf.ch/P3Export/P3_GrantExport_with_abstracts.csv',
              destfile = 'data-raw/P3/P3_GrantExport_with_abstracts.csv',
              method = 'curl')

zip(zipfile = "data-raw/P3/P3_GrantExport_with_abstracts", 
    files = "data-raw/P3/P3_GrantExport_with_abstracts.csv")

file.remove("data-raw/P3/P3_GrantExport_with_abstracts.csv")



download.file(url = 'http://p3.snf.ch/P3Export/P3_PersonExport.csv',
              destfile = 'data-raw/P3/P3_PersonExport.csv',
              method = 'curl')

zip(zipfile = "data-raw/P3/P3_PersonExport", 
    files = "data-raw/P3/P3_PersonExport.csv")

file.remove("data-raw/P3/P3_PersonExport.csv")



download.file(url = 'http://p3.snf.ch/P3Export/P3_PublicationExport.csv',
              destfile = 'data-raw/P3/P3_PublicationExport.csv',
              method = 'curl')

zip(zipfile = "data-raw/P3/P3_PublicationExport", 
    files = "data-raw/P3/P3_PublicationExport.csv")

file.remove("data-raw/P3/P3_PublicationExport.csv")



download.file(url = 'http://p3.snf.ch/P3Export/P3_GrantOutputDataExport.csv',
              destfile = 'data-raw/P3/P3_GrantOutputDataExport.csv',
              method = 'curl')

zip(zipfile = "data-raw/P3/P3_GrantOutputDataExport", 
    files = "data-raw/P3/P3_GrantOutputDataExport.csv")

file.remove("data-raw/P3/P3_GrantOutputDataExport.csv")



download.file(url = 'http://p3.snf.ch/P3Export/P3_CollaborationExport.csv',
              destfile = 'data-raw/P3/P3_CollaborationExport.csv',
              method = 'curl')

zip(zipfile = "data-raw/P3/P3_CollaborationExport", 
    files = "data-raw/P3/P3_CollaborationExport.csv")

file.remove("data-raw/P3/P3_CollaborationExport.csv")
```

